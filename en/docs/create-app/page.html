<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Development Page</title>
    <script src="https://cdn.jsdelivr.net/gh/kirakiray/ofa.js@4.3.14/dist/ofa.min.js"></script>
    <script
      src="https://cdn.jsdelivr.net/gh/kirakiray/ofa.js@4.3.14/libs/scsr/scsr.mjs"
      type="module"
    ></script>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/obook@2.1.1/statics/css/public.css" />
    <style>
      html,
      body {
        height: 100%;
      }
    </style>
    <script>
      let configUrl = "../../config.json";
    </script>
    
        <script async="" src="https://www.googletagmanager.com/gtag/js?id=G-7L1TCCJZT6"></script>
        <script>
          window.dataLayer = window.dataLayer || [];
          function gtag() {
            dataLayer.push(arguments);
          }
          gtag("js", new Date());

          gtag("config", "G-7L1TCCJZT6");
        </script>
        <script src="/init-sw.js"></script>
      
  </head>
  <body>
    <l-m src="https://cdn.jsdelivr.net/npm/obook@2.1.1/statics/comps/doc-container.html"></l-m>
    <l-m src="https://cdn.jsdelivr.net/npm/obook@2.1.1/statics/comps/doc-header/doc-header.html"></l-m>
    <o-app src="https://cdn.jsdelivr.net/npm/obook@2.1.1/statics/app-config.mjs">
      <template page>
        <style>
          .markdown-body::before,
          .markdown-body::after {
            display: block;
            content: "";
            height: 1px;
          }
          .markdown-body::after {
            height: 32px;
          }
        </style>
        <link
          rel="stylesheet"
          href="https://cdn.jsdelivr.net/npm/obook@2.1.1/statics/css/github-markdown.css"
        />
        <article class="markdown-body"><h1>Development Page</h1>
<p>Inside ofa.js, we have created a custom component called &#39;o-page&#39;, which aims to provide convenience for page development. This component plays a key role in application development. When you want to use the component&#39;s template syntax but don&#39;t want to create a completely new component, the &#39;o-page&#39; component will be your best choice.</p>
<h2>Page Module</h2>
<p>When creating a single-file page module, it is similar to creating a component module. Use the <code>template</code> tag to wrap the template code of the page and add the <code>page</code> attribute. Inside this tag, you can freely use template syntax to interact with other components or page modules.</p>
<pre><code class="language-html">&lt;!-- my-single-file-page.html --&gt;
&lt;template page&gt;
  &lt;h1&gt;{{pageTitle}}&lt;/h1&gt;
  &lt;p&gt;Welcome to my single file page!&lt;/p&gt;
  &lt;script&gt;
    // Avoid using import in the single-file mode
    // import data from &#39;./other/module.mjs&#39;;

    export default async ({ load }) =&gt; {
      // Reference other modules
      // const data = await load(&quot;./other/module.mjs&quot;);

      return {
        data: {
          pageTitle: &quot;My Single File Page&quot;,
        },
      };
    }
  &lt;/script&gt;
&lt;/template&gt;
</code></pre>
<p>In the HTML file, use the <code>o-page</code> tag&#39;s <code>src</code> attribute to specify the file path of the page module. The page content will be rendered inside this component.</p>
<pre><code class="language-html">&lt;!DOCTYPE html&gt;
&lt;html lang=&quot;en&quot;&gt;
&lt;head&gt;
  &lt;meta charset=&quot;UTF-8&quot;&gt;
  &lt;meta name=&quot;viewport&quot; content=&quot;width=device-width, initial-scale=1.0&quot;&gt;
  &lt;title&gt;My App&lt;/title&gt;
  &lt;script src=&quot;../../ofa.js&quot;&gt;&lt;/script&gt;
&lt;/head&gt;
&lt;body&gt;
  &lt;o-page src=&quot;./my-single-file-page.html&quot;&gt;&lt;/o-page&gt;
&lt;/body&gt;
&lt;/html&gt;
</code></pre>
<h2>Dual-file mode</h2>
<p>Dual-file mode separates <code>static templates</code> and <code>logic code</code> to make the content of the page more distinct.</p>
<p>The following are the steps to use the <code>o-page</code> component and page module:</p>
<ol>
<li>Create a page module:</li>
</ol>
<p>Similar to creating a component module, create a page module but set the <code>type</code> property to <code>$.PAGE</code>. The available parameters for the page module include <code>temp</code>, <code>data</code>, <code>proto</code>, and <code>watch</code>.</p>
<pre><code class="language-javascript">// my-page.mjs
export const type = $.PAGE;

export const temp = &quot;./my-page-template.html&quot;;

export const data = {
  pageTitle: &quot;My Page&quot;,
};

export const proto = {
  // ...
};

export const watch = {
  // ...
};
</code></pre>
<ol start="2">
<li>Create a page template:</li>
</ol>
<p>In the same directory as the page module, create a page template file named <code>my-page-template.html</code>. In this template file, you can use template syntax for interaction, similar to the component template syntax mentioned earlier.</p>
<pre><code class="language-html">&lt;!-- my-page-template.html --&gt;
&lt;h1&gt;{{pageTitle}}&lt;/h1&gt;
&lt;p&gt;Welcome to my page!&lt;/p&gt;
</code></pre>
<p>In your HTML file, use the <code>o-page</code> component with the <code>&lt;o-page&gt;</code> tag and reference the file path of the page module through the <code>src</code> attribute. The content of the page will be rendered inside this component.</p>
<pre><code class="language-html">&lt;!DOCTYPE html&gt;
&lt;html lang=&quot;en&quot;&gt;
&lt;head&gt;
  &lt;meta charset=&quot;UTF-8&quot;&gt;
  &lt;meta name=&quot;viewport&quot; content=&quot;width=device-width, initial-scale=1.0&quot;&gt;
  &lt;title&gt;My App&lt;/title&gt;
  &lt;script src=&quot;../../ofa.js&quot;&gt;&lt;/script&gt;
&lt;/head&gt;
&lt;body&gt;
  &lt;o-page src=&quot;./my-page.mjs&quot;&gt;&lt;/o-page&gt;
&lt;/body&gt;
&lt;/html&gt;
</code></pre>
<p>In this way, when you open the page, the <code>o-page</code> component will dynamically load the <code>my-page.mjs</code> page module and render the page content based on the template and data in the module. The lifecycle and template syntax of the page module are consistent with the component module, making the development and management of pages more unified and flexible.</p>
<h2>Check if the page has finished loading</h2>
<p>In some cases, you may need to check if the page has fully loaded in order to perform specific operations. <code>ofa.js</code> provides several ways to check if the page has finished loading.</p>
<h3>Using the <code>page._loaded</code> property</h3>
<p>In the page module, <code>page._loaded</code> is a boolean property that becomes <code>true</code> after the page content is fully loaded. You can use this property to check if the page has finished loading.</p>
<pre><code class="language-javascript">if (page._loaded) {
  // Page has finished loading
  // Perform your operations
} else {
  // Listen to the page-loaded event
  page.addEventListener(&#39;page-loaded&#39;, () =&gt; {
    // Operations to be performed after the page is loaded
  });
}
</code></pre>
<h3>Using the <code>page._rendered</code> property</h3>
<p>Another way is to use the <code>page._rendered</code> property, which is a Promise. This Promise enters the <code>resolve</code> state after the page is loaded. You can use <code>await page._rendered</code> to wait for the page to finish loading and then perform the corresponding operations.</p>
<pre><code class="language-javascript">async function doSomethingAfterPageLoad() {
  await page._rendered;
  // Page has finished loading
  // Perform your operations
}
</code></pre>

  <article-footer></article-footer>
  </article>
        <script>
          export const parent = "https://cdn.jsdelivr.net/npm/obook@2.1.1/statics/layouts/article-layout.html";

          import pageInit from "https://cdn.jsdelivr.net/npm/obook@2.1.1/statics/page-init.mjs";

          export default async (...args) => {
            return await pageInit(PATH, args);
          };
        </script>
      </template>
    </o-app>
    <div id="loading"></div>
    <script src="https://cdn.jsdelivr.net/npm/obook@2.1.1/statics/init.js" type="module"></script>
  </body>
</html>
